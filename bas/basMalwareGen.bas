Attribute VB_Name = "basMalwareGen"

Public Function CekMalwareGen(FileName As String, hFile As Long, MySize As Long) As String
Dim isiEXE    As String

Dim OutData()   As Byte
Dim OutData2()  As Byte

If isProperFile(FileName, "EXE DLL EML") = False Then CekMalwareGen = "": Exit Function
   If MySize > 9000 Then
      Call ReadUnicodeFile2(hFile, 1, 4500, OutData)   ' 4500 dari depan
      Call ReadUnicodeFile2(hFile, MySize - 4500, 4500, OutData2)
      isiEXE = StrConv(OutData, vbUnicode)
      isiEXE = isiEXE & StrConv(OutData2, vbUnicode) ' 4500 dari belakang
      Erase OutData()
      Erase OutData2()
   Else
      Call ReadUnicodeFile2(hFile, 1, MySize, OutData)
      isiEXE = StrConv(OutData, vbUnicode)
      Erase OutData()
   End If
   isiEXE = UCase(Replace(isiEXE, Chr(0), ""))   ' [pembufferan hilangkan char 0]
If Left(isiEXE, 4) = "MSCF" Then
If InStr(isiEXE, "MSFT") > 0 Then
CekMalwareGen = "Win32:Malware-Gen"
Exit Function
End If
End If
If Left(isiEXE, 2) = "HE" Then
If InStr(isiEXE, "IMISSYOU") > 0 Then
CekMalwareGen = "FakeMail.R[Vrt]"
Exit Function
End If
End If
End Function
